@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model AgentDashboardViewModel

<div class="card shadow mb-4">
    <div class="card-header">
        <strong class="card-title"> Pending Feedback Acknowledgement</strong>
    </div>
    <div class="card-body">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Transaction ID</th>
                    <th>Date</th>
                    <th>View</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.FeedbackList != null && Model.FeedbackList.Any())
                {
                    @foreach (var item in Model.FeedbackList)
                    {
                        bool isOlderThan24Hours = (DateTime.Now - item.CreatedDate).TotalHours > 24;

                        <tr>
                            <td class="@(isOlderThan24Hours ? "text-danger" : "")">
                                @item.TransactionID
                            </td>
                            <td>
                            @item.CreatedDate 
                             
                            </td>
                            <td>
                                <a href="/Agent/AgentFeedBack?TransactionID=@item.TransactionID" class="btn btn-primary btn-sm">
                                    View
                                </a>
                            </td>
                        </tr>
                    }

                }
                else
                {
                    <tr>
                        <td colspan="2" class="text-center">No pending feedback.</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@if (Model.ZtSignOffDataAgent != null && Model.ZtSignOffDataAgent.Any())
{
    <div id="popupModal" class="modal">
        <div class="modal-content">
            <h4>Sign-Off Details</h4>
            <div class="table-responsive-wrapper">
                <table class="table table-bordered table-striped">
                    <thead styel="color:#ffff; background-color:#525452">
                        <tr>
                            <th>Process</th>
                            <th>Subprocess</th>
                            <th>Procedure 1</th>
                            <th>Procedure 2</th>
                            <th>Procedure 3</th>
                            <th>Procedure 4</th>
                            <th>Procedure 5</th>
                            <th>Procedure 6</th>
                            <th>Procedure 7</th>
                            <th>Procedure 8</th>
                            <th>Procedure 9</th>
                            <th>Procedure 10</th>


                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.ZtSignOffDataAgent)
                        {
                            <tr>
                                <td>@item.Process</td>
                                <td>@item.SubProcessName</td>
                                <td>@item.Process_1</td>
                                <td>@item.Process_2</td>
                                <td>@item.Process_3</td>
                                <td>@item.Process_4</td>
                                <td>@item.Process_5</td>
                                <td>@item.Process_6</td>
                                <td>@item.Process_7</td>
                                <td>@item.Process_8</td>
                                <td>@item.Process_9</td>
                                <td>@item.Process_10</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <div class="btn-wrapper">
                <button class="close-btn" onclick="closePopup()">Agent acknowledement</button>
            </div>
        </div>
    </div>

    <style>

        .table-responsive-wrapper {
            overflow-x: auto;
            overflow-y: auto;
            max-height: 400px;
            margin-top: 15px;
            border: 1px solid #ddd;
        }

        .table {
            min-width: 1200px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1050;
            padding-top: 80px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(128, 128, 128, 0.6);
        }

        .modal-content {
            background-color: #fff;
            margin: auto;
            padding: 25px;
            border-radius: 10px;
            width: 80%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(128, 128, 128, 0.6);
            animation: fadeIn 0.4s ease-in-out;
        }

        .btn-wrapper {
            text-align: right;
            margin-top: 15px;
        }

        .close-btn {
            padding: 8px 16px;
            background-color: #007bff;
            border: none;
            color: white;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
        }

            .close-btn:hover {
                background-color: #0056b3;
            }

    </style>

    <script>
        window.onload = function () {
            document.getElementById("popupModal").style.display = "block";
        }

                      function closePopup() {
            document.getElementById("popupModal").style.display = "none";

            fetch('/QAManager/Agentacknowledements', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                console.log('Server Response:', data);
            })
            .catch(error => {
                console.error('AJAX Error:', error);
            });
        }


    </script>
}


<div class="card shadow mb-4">
    <div class="card-header">
        <strong class="card-title"> Pending Dispute Acknowledgement</strong>
    </div>
    <div class="card-body">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Transaction ID</th>
                    <th>Date</th>
                    <th>View</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.DisputeList != null && Model.DisputeList.Any())
                {
                    @foreach (var item in Model.DisputeList)
                    {
                        bool isOlderThan24Hours = (DateTime.Now - item.CreatedDate).TotalHours > 24;
                        <tr>
                            <td class="@(isOlderThan24Hours ? "text-danger" : "")">
                                @item.TransactionID
                            </td>
                            <td>
                               @item.CreatedDate 
                            
                            </td>
                            <td>
                                <a href="/Agent/AgentDisputeFeedBack?TransactionID=@item.TransactionID" class="btn btn-primary btn-sm">
                                    View
                                </a>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="2" class="text-center">No pending disputes.</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>




<script src="~/js/jquery.min.js"></script>
@await Html.PartialAsync("_MailModal")
<script src="~/js/xlsx.full.min.js"></script>

<script src="~/js/notification.js"></script>