@using System.Data
@model System.Data.DataTable
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using Microsoft.AspNetCore.Http
@if (TempData["ErrorMessages"] != null)
{
    var errorMessages = ((string[])TempData["ErrorMessages"]).ToList();
    @foreach (var message in errorMessages)

    {
        <div class="alert alert-primary" id="NotificationDiv" runat="server" role="alert">
            <span class="fe fe-alert-circle fe-16 mr-2" id="Notif   ication" runat="server">
                @message
            </span>
        </div>
    }

}

<form action="@Url.Action("InsertProcess", "Module")" method="post">
    <div class="col-md-12 my-4">
        <div class="card shadow">
            <div class="card-body">
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="LocationDropDown">Location Name</label> 
                        @Html.DropDownList(
                                 "Location_ID",
                                 (List<SelectListItem>)ViewBag.LocationName,
                                
                                 new { @class = "custom-select", id = "Location_ID", disabled = "disabled" }
                                 )
                    </div>
                    <div class="col-md-6">
                        <label for="Program">Program Name</label> <span style="color:red">*</span>
                        <input type="text" required id="txtProgram" name="Program" autocomplete="off" class="form-control" />
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-2">
                            <label for="DataRetention">Data Retention (Days)</label> <span style="color:red">*</span>
                            <input type="text" required id="txtDataRetention" name="DataRetentions" autocomplete="off" class="form-control" />
                        </div>
                    </div>
                    <div class="col-md-2 my-4">
                        <div class="card-body d-flex justify-content-center align-items-center">
                            <button type="submit" class="btn btn-primary">Create Process</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</form>

<div id="UserCardBody" style="visibility:hidden" class="col-md-12 my-4">
    <div class="card shadow">
        <div class="card-body">
            <table id="UserTable" style="visibility:hidden" class="table table-bordered table-hover mb-0">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>LocationName</th>

                        <th>ProcessName</th>
                        <th>Active_Status</th>
                        
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Edit Process</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="editForm">
                    <div class="form-group">
                        <label for="editSubProcess">Process Name</label>
                        <input type="text" class="form-control" id="editSubProcess" />
                        <input type="hidden" id="editSubProcessId" />
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="saveChanges()">Save changes</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const processList = @Html.Raw(Json.Serialize(ViewBag.ProcessList)); 
        const tableBody = document.querySelector('#UserTable tbody');
        processList.forEach(process => {
            const row = document.createElement('tr');

            row.innerHTML = `
                    <td>${process.id}</td>
                    <td>${process.locationName}</td>
                    <td>${process.processName}</td>
                    <td>${process.active_Status}</td>
                   
                `;

            tableBody.appendChild(row);
        });
        document.getElementById('UserCardBody').style.visibility = 'visible';
        document.getElementById('UserTable').style.visibility = 'visible';
    });

    function editProcess(id) {
        alert(`Edit process with ID: ${id}`);
    }
</script>